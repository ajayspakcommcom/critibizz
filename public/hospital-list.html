<html class="openNav">

<head>
  <title>Criti Bizz : Hospital List</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css" />
  <link rel="stylesheet" href="css/admin.css" />
  <script src="js/jquery.min.js"></script>
</head>

<body>
  <div class="primary-nav" id="loadAdminHeader"></div>

  <div class="new-wrapper">
    <div id="main">
     <div id="topnav"></div>
      <div id="main-contents">
        <h1 class="m-b-10"><span id="hospName"></span> : Hospitals</h1>
        <div class="container">
          <div class="custom-table custom-table-with-border">
            <div class="zone-profile">
            </div>
            <form>

              <div class="hospital-list-filter">

                <div class="form-group">
                  <select class="form-control" id="cmbMonth">
                    <option value="1">Jan</option>
                    <option value="2">Feb</option>
                    <option value="3">Mar</option>
                    <option value="4">Apr</option>
                    <option value="5">May</option>
                    <option value="6">Jun</option>
                    <option value="7">Jul</option>
                    <option value="8">Aug</option>
                    <option value="9">Sep</option>
                    <option value="10">Oct</option>
                    <option value="11">Nov</option>
                    <option value="12">Dec</option>
                  </select>
                </div>

                <div class="form-group">
                  <select class="form-control" id="cmbYear">
                    <option value="2022">2022</option>
                    <option value="2023">2023</option>
                  </select>
                </div>

                <div class="form">
                  <button type="button" onclick="getHospitalList();" class="btn">Go</button>
                </div>

              </div>



            </form>
            <table class="table table-bordered table-striped grey-box">
              <thead>
                <tr>
                  <th>Hospital Name</th>
                  <th>Employee Name</th>
                  <th>Region</th>
                  <th>Actual Units</th>
                  <th>Potential Units</th>
                  <th>Target Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="loadHospitalList"></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="loader-wrapper none">
    <div class="loader"></div>
  </div>

  <script src="js/jquery.min.js"></script>
  <script src="https://unpkg.com/axios/dist/axios.min.js"></script>
  <script src="https://unpkg.com/ionicons@5.1.2/dist/ionicons.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.js"></script>
  <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>

  <script src="js/app.js"></script>


  <script>

    function setUpPage() {
      setupTopNav();
      let urlParams = new URLSearchParams(window.location.search);
      $('#hospName').text(camelCaseText(urlParams.get('name')));
      $('#cmbMonth').val(urlParams.get('mon'));
      $('#cmbYear').val(urlParams.get('year'));
      loadManagers();
     
    }


    function getHospitalList() {

      $('.loader-wrapper').removeClass('none');
      let param = {
        parentId: 1,
        method: 'getHospitalList',
        stateName: $('#hospName').text(),
        mon: $('#cmbMonth').val(),
        year: $('#cmbYear').val()
      };

      axios
        .post("/api", param)
        .then((response) => {
          let hospitalList = response.data[0],
            showHtml = [],
            mon = $('#cmbMonth').val(),
            year = $('#cmbYear').val();

          // // <td>${camelCaseText(currVal.hospitalName)}</td>
          hospitalList.forEach((item) => {
            showHtml.push(` <tr>
                          <td>${item.hospitalName}</td>
                          <td>${camelCaseText(item.EmpName)}</td>
                          <td>${item.regionName}</td>
                          <td>${item.totalActual}</td>
                          <td>${item.TotalPotential}</td>
                          <td>${parseInt(item.TotalPotential) <= parseInt(item.totalActual) ? `Green` : `red`} </td>
                          <td><a href="/hospital-detail?hid=${item.hospitalId}&mon=${mon}&year=${year}&name=${$('#hospName').text()}" class="h-detail"><span>View in Detail</span> <img src="img/file.png" alt="view detail" /> </a></td>
                        </tr>   `);
          });
          $('#loadHospitalList').html(showHtml.join(''));
          $('.loader-wrapper').addClass('none');
        });
    }
    setUpPage();
    getHospitalList();
  </script>

</body>

</html>